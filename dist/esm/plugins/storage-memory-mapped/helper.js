import{fillWithDefaultSettings as e,normalizeMangoQuery as t,prepareQuery as r}from"rxdb/plugins/core";export var MEMORY_MAPPED_SCHEMA_TITLE="RxJsonSchemaMemoryMappedPersistenceBlock";export var MEMORY_MAPPED_ID_SIZE=12;export function getMemoryMappedPersistenceSchema(t){var r=t.encrypted&&t.encrypted.length>0,n={title:MEMORY_MAPPED_SCHEMA_TITLE,primaryKey:"id",type:"object",version:t.version,keyCompression:t.keyCompression,properties:{id:{type:"string",maxLength:MEMORY_MAPPED_ID_SIZE,minLength:MEMORY_MAPPED_ID_SIZE},c:{type:"boolean"},s:{type:"array",items:{type:"string",maxLength:MEMORY_MAPPED_ID_SIZE,minLength:MEMORY_MAPPED_ID_SIZE}},d:{type:"array",minItems:1,items:{type:"object",properties:t.properties,required:t.required,additionalProperties:!1}}},required:["id","c","s","d"],encrypted:r?["d"]:void 0,indexes:[["c"]]};return r&&(n.properties.d={type:"string"}),e(n)}export async function getNextBlockId(e){var t=await e.internals.initDonePromise,r=((t.lastBlockId?parseInt(t.lastBlockId):0)+1+"").padStart(MEMORY_MAPPED_ID_SIZE,"0");return t.lastBlockId=r,r}export async function getNonCleanedUpBlocks(e){return(await e.query(r(e.schema,t(e.schema,{selector:{c:{$eq:!1},_deleted:{$eq:!1}},sort:[{id:"desc"}]})))).documents}