import{getFromMapOrThrow as e}from"rxdb/plugins/utils";import{exposeRxStorageRemote as o}from"rxdb/plugins/storage-remote";import{Subject as s}from"rxjs";export function exposeWorkerRxStorage(t){var r;console.log("exposeWorkerRxStorage()");var n=new s;if("undefined"!=typeof self&&"object"==typeof self.onconnect){var a=new Map;self.onconnect=e=>{var o=e.ports[0];o.onmessage=e=>{var s=e.data;a.set(s.connectionId,o),n.next(s)}},r={storage:t.storage,messages$:n,send(o){e(a,o.connectionId).postMessage(o)}}}else addEventListener("message",(e=>{var o=e.data;n.next(o)})),r={storage:t.storage,messages$:n,send(e){self.postMessage(e)}};o(r)}