import{ensureNotFalsy as e,getStartIndexStringFromLowerBound as r,getStartIndexStringFromUpperBound as s}from"rxdb/plugins/core";import{getIndexName as t}from"../storage-indexeddb/index.js";import{compareIndexRows as n}from"./helpers.js";import{boundLE as o,boundGE as i,boundGT as a,boundLT as m}from"rxdb/plugins/storage-memory";export async function abstractFilesystemCount(d,u,c){var f=await d.internals.statePromise,l=u.queryPlan.index.slice(0),p=t(l),x=e(f.indexStates.find((e=>e.name===p)));if(0===x.rows.length)return{count:0,mode:"fast"};for(var y=u.queryPlan,b=y.index,g=y.startKeys,w=r(d.schema,b,g),h=y.endKeys,v=s(d.schema,b,h),P=(y.inclusiveStart?i:a)(x.rows,[w],n),j=(y.inclusiveEnd?o:m)(x.rows,[v],n),q=0,K=!1;!K;){if(!x.rows[P]||P>j)break;q+=1,P++}return{count:q,mode:"fast"}}