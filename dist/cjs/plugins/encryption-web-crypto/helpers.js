Object.defineProperty(exports,"__esModule",{value:!0}),exports.TEXT_ENCODER=exports.TEXT_DECODER=exports.MINIMUM_PASSWORD_LENGTH=exports.KEY_FORMAT=exports.GENERATE_KEY_KEY_USAGES=void 0,exports.ab2b64=c,exports.b642ab=u,exports.createPassword=p,exports.decryptString=y,exports.encryptString=E,exports.getCryptoKey=s,exports.getDefaultSeed=a,exports.getPasswordKey=o,exports.getSettingsForAlgoritm=i;var e=require("rxdb/plugins/utils"),r=exports.GENERATE_KEY_KEY_USAGES=["encrypt","decrypt"],t=(exports.KEY_FORMAT="jwk",exports.TEXT_ENCODER=new TextEncoder),n=exports.TEXT_DECODER=new TextDecoder;exports.MINIMUM_PASSWORD_LENGTH=8;function o(e){return crypto.subtle.importKey("raw",t.encode(e),"PBKDF2",!1,["deriveKey"])}function a(){return u("Cydnw5jCrQoBL8K1GsK5GMKDBynCgA==")}async function s(e,t,n){var a=await o(e);return await crypto.subtle.deriveKey({name:"PBKDF2",salt:n,iterations:784,hash:"SHA-256"},a,i(t,!0),!1,r)}function i(e,r){var t={name:e,hash:{name:"SHA-256"},length:256,modulusLength:204};return"AES-GCM"===e&&(t.tagLength=128),"AES-CTR"===e&&(t.counter=new Uint8Array(16),t.length=128),r&&("AES-CBC"===e&&(t.iv=crypto.getRandomValues(new Uint8Array(16))),"AES-GCM"===e&&(t.tagLength=128,t.iv=crypto.getRandomValues(new Uint8Array(12)))),t}function p(r){return Promise.resolve({algorithm:r,password:(0,e.randomCouchString)(15)})}function c(r){var t=(0,e.arrayBufferToString)(r);return(0,e.b64EncodeUnicode)(t)}function u(r){var t=(0,e.b64DecodeUnicode)(r);return(0,e.stringToArrayBuffer)(t)}async function E(e,r,n){var o=i(r,!0);return c(await crypto.subtle.encrypt(o,e,t.encode(n)))+"."+(o.iv?c(o.iv):"")}async function y(e,r,t){var[o,a]=t.split("."),s=u(a),p=u(o),c=i(r,!0);c.iv=s;var E=await crypto.subtle.decrypt(c,e,p);return n.decode(E)}