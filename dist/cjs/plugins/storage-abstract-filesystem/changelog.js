Object.defineProperty(exports,"__esModule",{value:!0}),exports.addChangelogOperations=i,exports.getChangelogFile=r,exports.getChangelogOperations=a;var e=require("rxdb/plugins/core"),t=require("./file-abstraction.js"),n=require("./index-state.js");function r(e,r,a){return new t.AbstractFile(e.then((e=>e.getFileHandle("changelog.txt",{create:!0}))),0,[{type:"number",length:n.INDEX_ID_LENGTH},{type:"number",length:n.INDEX_ROW_ID_LENGTH},{type:"string",length:1},{type:"string",length:r},{type:"number",length:a},{type:"number",length:a}])}async function a(t,n,r,a=0){var i={lastRowId:a,operationsByIndexId:new Map};return await n.readRows(t,a,(t=>{i.lastRowId=i.lastRowId+1;var[n,a,o,g,s,l]=t,p=(0,e.getFromMapOrCreate)(i.operationsByIndexId,n,(()=>[])),d=r[n],u=g.slice(0,d.indexableStringLength),y=(0,e.getPrimaryKeyFromIndexableString)(u,d.primaryKeyLength).trim();p.push([n,a,o,[u,y,s,l]])})),i}async function i(e,t,n,r){var a=n.map((e=>[e[0],e[1],e[2],e[3][0].padEnd(r),e[3][2],e[3][3]]));await t.appendRows(e,a)}