Object.defineProperty(exports,"__esModule",{value:!0}),exports.abstractFilesystemCount=s;var e=require("rxdb/plugins/core"),r=require("../storage-indexeddb/index.js"),n=require("./helpers.js"),t=require("rxdb/plugins/storage-memory");async function s(s,o,a){var d=await s.internals.statePromise,i=o.queryPlan.index.slice(0),u=(0,r.getIndexName)(i),c=(0,e.ensureNotFalsy)(d.indexStates.find((e=>e.name===u)));if(0===c.rows.length)return{count:0,mode:"fast"};for(var l=o.queryPlan,m=l.index,x=l.startKeys,b=(0,e.getStartIndexStringFromLowerBound)(s.schema,m,x),g=l.endKeys,p=(0,e.getStartIndexStringFromUpperBound)(s.schema,m,g),y=(l.inclusiveStart?t.boundGE:t.boundGT)(c.rows,[b],n.compareIndexRows),f=(l.inclusiveEnd?t.boundLE:t.boundLT)(c.rows,[p],n.compareIndexRows),w=0,q=!1;!q;){if(!c.rows[y]||y>f)break;w+=1,y++}return{count:w,mode:"fast"}}