Object.defineProperty(exports,"__esModule",{value:!0});var e={getRxStorageSharding:!0};exports.getRxStorageSharding=c;var r=require("rxdb/plugins/core"),a=require("../../plugins/shared/version-check.js"),t=require("./rx-storage-instance-sharding.js");Object.keys(t).forEach((function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||r in exports&&exports[r]===t[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return t[r]}}))}));var n=require("./sharding-helper.js");Object.keys(n).forEach((function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||r in exports&&exports[r]===n[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return n[r]}}))}));var s=require("./sharding-types.js");Object.keys(s).forEach((function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||r in exports&&exports[r]===s[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return s[r]}}))}));var o=require("../shared/rxdb-premium-version.js");function c(e){var n={name:"sharding",rxdbVersion:o.RXDB_PREMIUM_VERSION,async createStorageInstance(s){(0,r.ensureRxStorageInstanceParamsAreCorrect)(s),(0,a.checkVersion)();var o=s.schema.sharding?s.schema.sharding.shards:2,c=s.schema.sharding?s.schema.sharding.mode:"collection",i={shardInstances:await Promise.all(new Array(o).fill(0).map(((r,a)=>{var t="-"+a+"-of-"+o,n=s.databaseName+("database"===c?t:""),i=s.collectionName+("collection"===c?t:"");return e.storage.createStorageInstance({databaseInstanceToken:s.databaseInstanceToken,databaseName:n,collectionName:i,multiInstance:s.multiInstance,options:s.options?s.options.parentOptions:{},schema:s.schema,devMode:s.devMode})})))};return new t.RxStorageInstanceSharding(n,s.databaseName,s.collectionName,s.schema,i,s.options)}};return n}